name: Testing Engine & Building Sandbox
on: [push]
jobs:
  Test-Engine-Build-Sandbox:
    runs-on: windows-latest
    steps:
      - name: Installing Dependencies
        uses: actions/checkout@v2
        with:
          submodules: 'true'
      - name: Installing Mono
        run: |
          echo "Installing Mono"
          curl -O -J "https://download.mono-project.com/archive/6.10.0/windows-installer/mono-6.10.0.104-x64-0.msi"
          msiexec -i "mono-6.10.0.104-x64-0.msi" -passive -qn -norestart
      - name: Building Project
        run: |
          cmake . -DCMAKE_GENERATOR_PLATFORM=x64 -DCMAKE_DISABLE_PRECOMPILE_HEADERS=true
          cmake --build . --config Release --parallel 1 --target Sandbox
          cmake --build . --config Release --parallel 1 --target TestNiceDay
          cmake -DTT_TARGET_DIR="${{ github.workspace }}/TestNiceDay/Release" -P CopyMonoDll.cmake
      - name: Testing Engine
        run: |
          ctest --output-on-failure
      - run: echo "üçè This job's status is ${{ job.status }}."
